
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>17.性能测试 · MySQL搬砖</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="suredandan">
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-prism/prism-solarizedlight.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-page-toc-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-back-to-top-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="18.replication.html" />
    
    
    <link rel="prev" href="16.basetest.html" />
    

    
        <link rel="shortcut icon" href='favicon.ico' type="image/x-icon">
    
    
        <link rel="bookmark" href='favicon.ico' type="image/x-icon">
    
    
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                        <b>1.1.</b>
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="1.introduceandinstall.html">
            
                <a href="1.introduceandinstall.html">
            
                    
                        <b>1.2.</b>
                    
                    1.MySQL介绍与安装
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="2.connectandrole.html">
            
                <a href="2.connectandrole.html">
            
                    
                        <b>1.3.</b>
                    
                    2.MySQL的连接与权限
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="3.parameterintro.html">
            
                <a href="3.parameterintro.html">
            
                    
                        <b>1.4.</b>
                    
                    3.MySQL参数详解
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="4.jiagoujieshao.html">
            
                <a href="4.jiagoujieshao.html">
            
                    
                        <b>1.5.</b>
                    
                    4.MySQL体系介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="5.cuncunyinqin.html">
            
                <a href="5.cuncunyinqin.html">
            
                    
                        <b>1.6.</b>
                    
                    5.MySQL的存储引擎
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="6.duoshili.html">
            
                <a href="6.duoshili.html">
            
                    
                        <b>1.7.</b>
                    
                    6.MySQL多实例
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="7.aboutssl.html">
            
                <a href="7.aboutssl.html">
            
                    
                        <b>1.8.</b>
                    
                    7.MySQL的SSL相关
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="8.datatypeintro.html">
            
                <a href="8.datatypeintro.html">
            
                    
                        <b>1.9.</b>
                    
                    8.MySQL的数据类型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="9.createtable.html">
            
                <a href="9.createtable.html">
            
                    
                        <b>1.10.</b>
                    
                    9.表的创建
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="10.sqlselect.html">
            
                <a href="10.sqlselect.html">
            
                    
                        <b>1.11.</b>
                    
                    10.SQL之select
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="11.sqldml.html">
            
                <a href="11.sqldml.html">
            
                    
                        <b>1.12.</b>
                    
                    11.SQL之增删改
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="12.sqlextra.html">
            
                <a href="12.sqlextra.html">
            
                    
                        <b>1.13.</b>
                    
                    12.SQL其他补充
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="13.cfqandccgc.html">
            
                <a href="13.cfqandccgc.html">
            
                    
                        <b>1.14.</b>
                    
                    13.触发器存储过程函数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="14.backrecover.html">
            
                <a href="14.backrecover.html">
            
                    
                        <b>1.15.</b>
                    
                    14.备份与恢复
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="15.backuprecoverpxb.html">
            
                <a href="15.backuprecoverpxb.html">
            
                    
                        <b>1.16.</b>
                    
                    15.备份恢复-pxb
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="16.basetest.html">
            
                <a href="16.basetest.html">
            
                    
                        <b>1.17.</b>
                    
                    16.基准测试
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.18" data-path="17.performancetest.html">
            
                <a href="17.performancetest.html">
            
                    
                        <b>1.18.</b>
                    
                    17.性能测试
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.19" data-path="18.replication.html">
            
                <a href="18.replication.html">
            
                    
                        <b>1.19.</b>
                    
                    18.主从复制
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20" data-path="19.haintro.html">
            
                <a href="19.haintro.html">
            
                    
                        <b>1.20.</b>
                    
                    19.高可用选型介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.21" data-path="20.performance.html">
            
                <a href="20.performance.html">
            
                    
                        <b>1.21.</b>
                    
                    20.优化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.22" data-path="21.sqltunning.html">
            
                <a href="21.sqltunning.html">
            
                    
                        <b>1.22.</b>
                    
                    21.SQL优化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.23" data-path="22.mysqlfaq.html">
            
                <a href="22.mysqlfaq.html">
            
                    
                        <b>1.23.</b>
                    
                    22.MySQL_FAQ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.24" data-path="fulu.html">
            
                <a href="fulu.html">
            
                    
                        <b>1.24.</b>
                    
                    附录
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.24.1" data-path="f_lvsvsnginxvshaproxy.html">
            
                <a href="f_lvsvsnginxvshaproxy.html">
            
                    
                        <b>1.24.1.</b>
                    
                    附录1-三大软负载均衡器对比
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.24.2" data-path="f_mysql5.7.html">
            
                <a href="f_mysql5.7.html">
            
                    
                        <b>1.24.2.</b>
                    
                    附录2-MySQL5.7新特性
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.24.3" data-path="f_sampleschema.html">
            
                <a href="f_sampleschema.html">
            
                    
                        <b>1.24.3.</b>
                    
                    附录3-MySQL的sample数据库安装部署
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.24.4" data-path="f_youhuakuangjia.html">
            
                <a href="f_youhuakuangjia.html">
            
                    
                        <b>1.24.4.</b>
                    
                    附录4-MySQL优化框架
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.24.5" data-path="f_usingprofile4sql.html">
            
                <a href="f_usingprofile4sql.html">
            
                    
                        <b>1.24.5.</b>
                    
                    附录5-使用profile分析sql
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.24.6" data-path="f_mysqlcheck.html">
            
                <a href="f_mysqlcheck.html">
            
                    
                        <b>1.24.6.</b>
                    
                    附录6-mysqlcheck的使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.24.7" data-path="f_mha.html">
            
                <a href="f_mha.html">
            
                    
                        <b>1.24.7.</b>
                    
                    附录7-mha配置.md
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >17.性能测试</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <!-- toc -->
<ul>
<li><a href="#%E4%B8%80%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95">&#x4E00;&#x3001;&#x6027;&#x80FD;&#x6D4B;&#x8BD5;</a><ul>
<li><a href="#1tpc-c">1.TPC-C</a></li>
<li><a href="#2tpcc-mysql">2.tpcc-mysql</a><ul>
<li><a href="#21-tpcc-mysql%E7%9A%84%E5%AE%89%E8%A3%85">2.1 tpcc-mysql&#x7684;&#x5B89;&#x88C5;</a></li>
<li><a href="#22-tpcc-mysql-%E6%B5%8B%E8%AF%95">2.2 tpcc-mysql &#x6D4B;&#x8BD5;</a></li>
</ul>
</li>
<li><a href="#3mysqlslap">3.mysqlslap</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->
<hr>
<h1 id="&#x4E00;&#x3001;&#x6027;&#x80FD;&#x6D4B;&#x8BD5;">&#x4E00;&#x3001;&#x6027;&#x80FD;&#x6D4B;&#x8BD5;</h1>
<h2 id="1tpc-c">1.TPC-C</h2>
<ul>
<li>&#x4E13;&#x95E8;&#x9488;&#x5BF9;&#x8054;&#x673A;&#x4EA4;&#x6613;&#x5904;&#x7406;&#x7CFB;&#x7EDF;&#xFF08;OLTP&#x7CFB;&#x7EDF;&#xFF09;&#x7684; &#x89C4;&#x8303;</li>
<li>&#x8BE5;&#x7CFB;&#x7EDF;&#x9700;&#x8981;&#x5904;&#x7406;&#x7684;&#x4EA4;&#x6613;&#x4E8B;&#x52A1;&#x4E3B;&#x8981;&#x4E3A;&#x4EE5;&#x4E0B;&#x51E0;&#x79CD;&#xFF1A;&#xFF08;&#x504F;&#x5411;&#x4E8E;&#x7535;&#x5546;&#x7C7B;&#xFF09;<ul>
<li>&#x65B0;&#x8BA2;&#x5355;&#xFF08;New&#x2010;Order&#xFF09; &#xFF1A;&#x5BA2;&#x6237;&#x8F93;&#x5165;&#x4E00;&#x7B14;&#x65B0;&#x7684;&#x8BA2;&#x8D27;&#x4EA4;&#x6613;&#xFF1B;</li>
<li>&#x652F;&#x4ED8;&#x64CD;&#x4F5C;&#xFF08;Payment&#xFF09; &#xFF1A;&#x66F4;&#x65B0;&#x5BA2;&#x6237;&#x5E10;&#x6237;&#x4F59;&#x989D;&#x4EE5;&#x53CD;&#x6620;&#x5176;&#x652F;&#x4ED8;&#x72B6;&#x51B5;&#xFF1B;</li>
<li>&#x53D1;&#x8D27;&#xFF08;Delivery&#xFF09; &#xFF1A;&#x53D1;&#x8D27;&#xFF08;&#x6A21;&#x62DF;&#x6279;&#x5904;&#x7406;&#x4EA4;&#x6613;&#xFF09;&#xFF1B;</li>
<li>&#x8BA2;&#x5355;&#x72B6;&#x6001;&#x67E5;&#x8BE2;&#xFF08;Order&#x2010;Status&#xFF09; &#xFF1A;&#x67E5;&#x8BE2;&#x5BA2;&#x6237;&#x6700;&#x8FA2;&#x4EA4;&#x6613;&#x7684;&#x72B6;&#x6001;&#xFF1B;</li>
<li>&#x5E93;&#x5B58;&#x72B6;&#x6001;&#x67E5;&#x8BE2;&#xFF08;Stock&#x2010;Level&#xFF09; &#xFF1A;&#x67E5;&#x8BE2;&#x4ED3;&#x5E93;&#x5E93;&#x5B58;&#x72B6;&#x51B5;&#xFF0C;&#x4EE5;&#x4FBF;&#x80FD;&#x591F;&#x53CA;&#x65F6;&#x8865;&#x8D27;</li>
</ul>
</li>
<li>&#x8861;&#x91CF;&#x5355;&#x4F4D;&#xFF1A; tpmC &#x2013; transaction per minute<ul>
<li>&#x6D4B;&#x8BD5;&#x51FA;&#x6765;&#x7684;TPS&#x6BD4;&#x8F83;&#x4F4E;&#xFF0C;&#x6240;&#x4EE5;&#x4E58;&#x4EE5;60&#xFF0C;&#x6570;&#x636E;&#x6BD4;&#x8F83;&#x597D;&#x770B;</li>
<li>&#x6A21;&#x62DF;&#x7EBF;&#x4E0A;&#x4E1A;&#x52A1;&#xFF0C;&#x6BD4;&#x8F83;&#x8D34;&#x8FD1;&#x5B9E;&#x9645;<h2 id="2tpcc-mysql">2.tpcc-mysql</h2>
&#x7531;Percona&#x516C;&#x53F8;&#x5F00;&#x53D1;&#x7684;tpcc&#x6D4B;&#x8BD5;&#x5DE5;&#x5177;&#xFF0C;&#x4EC5;&#x9488;&#x5BF9;&#x4E8E;MySQL&#x6570;&#x636E;&#x5E93;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;&#xFF0C;&#x548C;sysbench&#x4E0D;&#x540C;&#xFF0C;TPCC&#x6D4B;&#x8BD5;&#x4E2D;&#xFF0C;&#x6570;&#x636E;&#x5E93;&#x7684;&#x603B;&#x5BB9;&#x91CF;&#x662F;&#x5728;&#x6162;&#x6162;&#x53D8;&#x5927;&#x7684;&#xFF08; &#x6240;&#x4EE5;&#x5230;&#x540E;&#x9762;&#xFF0C;&#x6027;&#x80FD;&#x4F1A;&#x6162;&#x6162;&#x4E0B;&#x964D; &#xFF09;&#x3002;
&#x4E0B;&#x9762;&#x662F;tpcc-mysql&#x7684;ER&#x56FE;&#xFF0C;&#x4EE5;&#x53CA;&#x5404;&#x6570;&#x636E;&#x8868;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;&#x6BD4;&#x4F8B;
<img src="images/screenshot_1532483023604.png" alt="">
<img src="images/screenshot_1532483198037.png" alt="">
<img src="images/screenshot_1532483207784.png" alt=""></li>
</ul>
</li>
</ul>
<h3 id="21-tpcc-mysql&#x7684;&#x5B89;&#x88C5;">2.1 tpcc-mysql&#x7684;&#x5B89;&#x88C5;</h3>
<h4 id="211-git-clone">2.1.1 git clone</h4>
<pre class="language-"><code>[root@nazeebo test]# git clone https://github.com/Percona-Lab/tpcc-mysql.git
Cloning into &apos;tpcc-mysql&apos;...
remote: Counting objects: 392, done.
remote: Total 392 (delta 0), reused 0 (delta 0), pack-reused 392
Receiving objects: 100% (392/392), 202.81 KiB | 125.00 KiB/s, done.
Resolving deltas: 100% (216/216), done.
[root@nazeebo test]# ll
drwxr-xr-x 6 root root 4096 Jul 24 17:16 tpcc-mysql
[root@nazeebo test]# cd tpcc-mysql/
[root@nazeebo tpcc-mysql]# ll
total 44
-rw-r--r-- 1 root root 1621 Jul 24 17:16 add_fkey_idx.sql --step2:&#x521B;&#x5EFA;&#x7D22;&#x5F15;
-rw-r--r-- 1 root root  317 Jul 24 17:16 count.sql
-rw-r--r-- 1 root root 3105 Jul 24 17:16 create_table.sql  --step1:&#x521B;&#x5EFA;&#x8868;
-rw-r--r-- 1 root root  194 Jul 24 17:16 Dockerfile
-rw-r--r-- 1 root root  763 Jul 24 17:16 drop_cons.sql
-rw-r--r-- 1 root root 1079 Jul 24 17:16 load_multi_schema.sh
-rw-r--r-- 1 root root  573 Jul 24 17:16 load.sh
-rw-r--r-- 1 root root 2302 Jul 24 17:16 README.md
drwxr-xr-x 2 root root 4096 Jul 24 17:16 schema2
drwxr-xr-x 5 root root 4096 Jul 24 17:16 scripts
drwxr-xr-x 2 root root 4096 Jul 24 17:16 src
</code></pre><h4 id="212-&#x7F16;&#x8BD1;&#xFF0C;&#x751F;&#x6210;tpccload&#x548C;tpccstart&#x5DE5;&#x5177;">2.1.2 &#x7F16;&#x8BD1;&#xFF0C;&#x751F;&#x6210;tpcc_load&#x548C;tpcc_start&#x5DE5;&#x5177;</h4>
<pre class="language-"><code>[root@nazeebo tpcc-mysql]# cd src/
[root@nazeebo src]# ls
delivery.c  load.c  Makefile  ordstat.c     payment.c  rthist.h         sb_percentile.h  sequence.h  spt_proc.c  support.c  trans_if.h
driver.c    main.c  neword.c  parse_port.h  rthist.c   sb_percentile.c  sequence.c       slev.c      spt_proc.h  tpc.h
[root@nazeebo src]# make 
cc -w -O3 -g -I. `mysql_config --include`  -c load.c
cc -w -O3 -g -I. `mysql_config --include`  -c support.c
cc load.o support.o `mysql_config --libs_r` -lrt -o ../tpcc_load
cc -w -O3 -g -I. `mysql_config --include`  -c main.c
cc -w -O3 -g -I. `mysql_config --include`  -c spt_proc.c
cc -w -O3 -g -I. `mysql_config --include`  -c driver.c
cc -w -O3 -g -I. `mysql_config --include`  -c sequence.c
cc -w -O3 -g -I. `mysql_config --include`  -c rthist.c
cc -w -O3 -g -I. `mysql_config --include`  -c sb_percentile.c
cc -w -O3 -g -I. `mysql_config --include`  -c neword.c
cc -w -O3 -g -I. `mysql_config --include`  -c payment.c
cc -w -O3 -g -I. `mysql_config --include`  -c ordstat.c
cc -w -O3 -g -I. `mysql_config --include`  -c delivery.c
cc -w -O3 -g -I. `mysql_config --include`  -c slev.c
cc main.o spt_proc.o driver.o support.o sequence.o rthist.o sb_percentile.o neword.o payment.o ordstat.o delivery.o slev.o `mysql_config --libs_r` -lrt -o ../tpcc_start
[root@nazeebo src]# cd ..
[root@nazeebo tpcc-mysql]# ll
total 312
-rw-r--r-- 1 root root   1621 Jul 24 17:16 add_fkey_idx.sql
-rw-r--r-- 1 root root    317 Jul 24 17:16 count.sql
-rw-r--r-- 1 root root   3105 Jul 24 17:16 create_table.sql
-rw-r--r-- 1 root root    194 Jul 24 17:16 Dockerfile
-rw-r--r-- 1 root root    763 Jul 24 17:16 drop_cons.sql
-rw-r--r-- 1 root root   1079 Jul 24 17:16 load_multi_schema.sh
-rw-r--r-- 1 root root    573 Jul 24 17:16 load.sh
-rw-r--r-- 1 root root   2302 Jul 24 17:16 README.md
drwxr-xr-x 2 root root   4096 Jul 24 17:16 schema2
drwxr-xr-x 5 root root   4096 Jul 24 17:16 scripts
drwxr-xr-x 2 root root   4096 Jul 24 17:19 src
-rwxr-xr-x 1 root root  81112 Jul 24 17:19 tpcc_load
-rwxr-xr-x 1 root root 188640 Jul 24 17:19 tpcc_start
</code></pre><h4 id="213-&#x521B;&#x5EFA;&#x8868;&#xFF0C;&#x751F;&#x6210;&#x6570;&#x636E;">2.1.3 &#x521B;&#x5EFA;&#x8868;&#xFF0C;&#x751F;&#x6210;&#x6570;&#x636E;</h4>
<pre class="language-"><code>1.&#x5148;&#x63D0;&#x524D;&#x521B;&#x5EFA;&#x597D;&#x5E93;tpcc1&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528;&#x811A;&#x672C;create_table.sql&#x521B;&#x5EFA;&#x8868;
root@nazeebo tpcc-mysql]#  mysql -u root -p123456 -S /tmp/mysql.sock tpcc &lt; create_table.sql
mysql: [Warning] Using a password on the command line interface can be insecure.
[root@nazeebo tpcc-mysql]#  mysql -u root -p123456 -S /tmp/mysql.sock tpcc -e &quot;show tables&quot;
mysql: [Warning] Using a password on the command line interface can be insecure.
+-----------------+
| Tables_in_tpcc1 |
+-----------------+
| customer        |
| district        |
| history         |
| item            |
| new_orders      |
| order_line      |
| orders          |
| stock           |
| warehouse       |
+-----------------+

2.&#x521B;&#x5EFA;&#x8868;&#x540E;&#xFF0C;&#x7528;tpcc_load&#x751F;&#x6210;&#x6570;&#x636E;
[root@nazeebo tpcc-mysql]# ./tpcc_load --help
*************************************
*** TPCC-mysql Data Loader        ***
*************************************
./tpcc_load: invalid option -- &apos;-&apos;
Usage: tpcc_load -h server_host -P port -d database_name -u mysql_user -p mysql_password -w warehouses -l part -m min_wh -n max_wh
* [part]: 1=ITEMS 2=WAREHOUSE 3=CUSTOMER 4=ORDERS
[root@nazeebo tpcc-mysql]# 

&#x5728;&#x8FD9;&#x513F;&#x521B;&#x5EFA;2&#x4E2A;&#x4ED3;&#x5E93;&#x7684;&#x6570;&#x636E;
[root@nazeebo tpcc-mysql]# ./tpcc_load -h nazeebo -P 3306 -d tpcc -u root -p 123456 -w 2
*************************************
*** TPCC-mysql Data Loader        ***
*************************************
option h with value &apos;nazeebo&apos;
option P with value &apos;3306&apos;
option d with value &apos;tpcc&apos;
option u with value &apos;root&apos;
option p with value &apos;123456&apos;
option w with value &apos;2&apos;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Parameters</span><span class="token punctuation">&gt;</span></span>
     [server]: nazeebo
     [port]: 3306
     [DBname]: tpcc
       [user]: root
       [pass]: 123456
  [warehouse]: 2
TPCC Data Load Started...
Loading Item 
.................................................. 5000
.................................................. 10000
.................................................. 15000
.................................................. 20000
.................................................. 25000
.................................................. 30000
.................................................. 35000
.................................................. 40000
.................................................. 45000
.................................................. 50000
.................................................. 55000
.................................................. 60000
.................................................. 65000
.................................................. 70000
.................................................. 75000
.................................................. 80000
.................................................. 85000
.................................................. 90000
.................................................. 95000
.................................................. 100000
Item Done. 
...
&#x7701;&#x7565;&#x5927;&#x90E8;&#x5206;&#x8F93;&#x51FA;
...

...DATA LOADING COMPLETED SUCCESSFULLY.

3.&#x521B;&#x5EFA;&#x5B8C;&#x6210;&#x540E;&#x521B;&#x5EFA;&#x7D22;&#x5F15;
[root@nazeebo tpcc-mysql]# mysql -u root -p -S /tmp/mysql.sock tpcc &lt; add_fkey_idx.sql
</code></pre><h4 id="214-&#x68C0;&#x67E5;&#x751F;&#x6210;&#x7684;&#x6570;&#x636E;">2.1.4 &#x68C0;&#x67E5;&#x751F;&#x6210;&#x7684;&#x6570;&#x636E;</h4>
<pre class="language-"><code>mysql&gt; use tpcc
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql&gt; select * from warehouse;
+------+-----------+----------------+----------------------+--------------------+---------+-----------+-------+-----------+
| w_id | w_name    | w_street_1     | w_street_2           | w_city             | w_state | w_zip     | w_tax | w_ytd     |
+------+-----------+----------------+----------------------+--------------------+---------+-----------+-------+-----------+
|    1 | SGjfdBiF6 | f0gUgEmWUpQOx  | W9TDbXY1lFhMRNcVIFVy | BCTgeG62BHWJkj     | IG      | 955868834 |  0.18 | 300000.00 |
|    2 | wtBvxidw  | SWSdQDVap2wJah | aqHCF6QCyZ5          | FipF8JfjktCKgEHzoy | Nm      | 397751947 |  0.17 | 300000.00 |
+------+-----------+----------------+----------------------+--------------------+---------+-----------+-------+-----------+
2 rows in set (0.00 sec)

mysql&gt; select count(1) from district;
+----------+
| count(1) |
+----------+
|       20 |  -- &#x56E0;&#x4E3A;&#x662F;1:10&#x7684;&#x5173;&#x7CFB;&#xFF0C;&#x6709;2&#x4E2A;&#x4ED3;&#x5E93;&#xFF0C;&#x5C31;&#x6709;20&#x4E2A;&#x5730;&#x533A;
+----------+
1 row in set (0.00 sec)

mysql&gt;  select count(1) from customer;
+----------+
| count(1) |
+----------+
|    60000 |  -- &#x56E0;&#x4E3A;&#x662F;1:30000&#xFF0C;&#x6240;&#x4EE5;&#x6709;2&#x4E2A;&#x4ED3;&#x5E93;&#xFF0C;&#x5C31;&#x6709;60000&#x4E2A;&#x7528;&#x6237;
+----------+
1 row in set (0.01 sec)
</code></pre><p>&#x4EE5;&#x4E0A;&#x5C31;&#x662F;&#x5C06;&#x6D4B;&#x8BD5;&#x7684;&#x6570;&#x636E;&#x751F;&#x6210;&#x597D;&#x4E86;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x5C31;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;&#x4E86;&#x3002;</p>
<blockquote>
<p>&#x6CE8;&#x610F;&#xFF1A;
&#x6D4B;&#x8BD5;&#x4E4B;&#x524D;&#xFF0C;&#x5EFA;&#x8BAE;&#x5148; &#x5907;&#x4EFD;tpcc&#x7684;&#x6570;&#x636E;&#x5E93; &#xFF0C;&#x7136;&#x540E;&#x5F00;&#x59CB;&#x6D4B;&#x8BD5;&#xFF0C;&#x56E0;&#x4E3A;tpcc&#x6D4B;&#x8BD5;&#x65F6;&#xFF0C;&#x6570;&#x636E;&#x91CF;&#x4F1A;&#x8D8A;&#x6765;&#x8D8A;&#x591A;&#xFF1B;&#x5F53;&#x4F60;&#x4FEE;&#x6539;&#x90E8;&#x5206;&#x53C2;&#x6570;&#x4EE5;&#x53CA;&#x4F18;&#x5316;&#x540E;&#xFF0C;&#x60F3;&#x8981;&#x505A;&#x5BF9;&#x6BD4;&#x6D4B;&#x8BD5;&#x65F6;&#xFF0C;&#x5C31;&#x4E0D;&#x80FD;&#x5728;&#x539F;&#x6765;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x8FDB;&#x884C;&#x6D4B;&#x8BD5;&#xFF08;&#x56E0;&#x4E3A;&#x6570;&#x636E;&#x91CF;&#x53D8;&#x5927;&#x4E86;&#xFF09;&#xFF0C;&#x9700;&#x8981;&#x7528;&#x5907;&#x4EFD;&#x7684;tpcc&#x5E93;&#x8FDB;&#x884C;&#x8FD8;&#x539F;&#x540E;&#xFF0C;&#x518D;&#x505A;&#x6D4B;&#x8BD5;&#x3002;&#x6700;&#x7B80;&#x5355;&#x7684;&#x662F;&#x76F4;&#x63A5;&#x505C;&#x673A;&#xFF0C;&#x62F7;&#x8D1D;&#x8D70;datadir&#x76EE;&#x5F55;&#x3002;</p>
</blockquote>
<h3 id="22-tpcc-mysql-&#x6D4B;&#x8BD5;">2.2 tpcc-mysql &#x6D4B;&#x8BD5;</h3>
<h4 id="221-&#x9884;&#x70ED;">2.2.1 &#x9884;&#x70ED;</h4>
<pre class="language-"><code>[root@nazeebo tpcc-mysql]# mysql -uroot -p123456 -S /tmp/mysql.sock tpcc &lt; count.sql
mysql: [Warning] Using a password on the command line interface can be insecure.
count(w_id)
2
count(d_w_id)
20
count(c_w_id)
60000
count(h_c_id)
60000
count(no_w_id)
18000
count(o_w_id)
60000
count(ol_w_id)
599639
count(i_id)
100000
count(s_w_id)
200000
[root@nazeebo tpcc-mysql]#
</code></pre><h4 id="222-&#x5F00;&#x59CB;&#x6D4B;&#x8BD5;">2.2.2 &#x5F00;&#x59CB;&#x6D4B;&#x8BD5;</h4>
<pre class="language-"><code>[root@nazeebo tpcc-mysql]# ./tpcc_start -h nazeebo -P 3306 -d tpcc -u root -p 123456 -w 2 -c 16 -r 10 -l 60
***************************************
*** ###easy### TPC-C Load Generator ***
***************************************
option h with value &apos;nazeebo&apos;
option P with value &apos;3306&apos;
option d with value &apos;tpcc&apos;
option u with value &apos;root&apos;
option p with value &apos;123456&apos;
option w with value &apos;2&apos;
option c with value &apos;16&apos;
option r with value &apos;10&apos;
option l with value &apos;60&apos;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Parameters</span><span class="token punctuation">&gt;</span></span>
     [server]: nazeebo
     [port]: 3306
     [DBname]: tpcc
       [user]: root
       [pass]: 123456
  [warehouse]: 2
 [connection]: 16
     [rampup]: 10 (sec.)
    [measure]: 60 (sec.)

RAMP-UP TIME.(10 sec.)

MEASURING START. --&#x4E0B;&#x9762;&#x8FD9;&#x6BCF;&#x9694;10&#x79D2;&#x6253;&#x5370;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x5C31;&#x662F;tpcc&#x7684;5&#x4E2A;&#x52A8;&#x4F5C;&#xFF0C;&#x8BA2;&#x5355;&#x3001;&#x652F;&#x4ED8;&#x3001;&#x53D1;&#x8D27;&#x3001;&#x8BA2;&#x5355;&#x67E5;&#x8BE2;&#x3001;&#x5E93;&#x5B58;&#x67E5;&#x8BE2;

  10, trx: 1482, 95%: 47.294, 99%: 73.085, max_rt: 170.466, 1476|247.195, 148|41.253, 148|393.725, 149|71.717
  20, trx: 1533, 95%: 43.427, 99%: 61.898, max_rt: 105.618, 1536|197.600, 153|11.631, 153|204.132, 153|66.841
  30, trx: 1520, 95%: 46.998, 99%: 65.954, max_rt: 81.930, 1520|167.517, 153|9.448, 153|207.713, 152|58.870
  40, trx: 1587, 95%: 41.297, 99%: 53.775, max_rt: 79.465, 1585|159.549, 158|9.081, 159|187.199, 159|64.726
  50, trx: 1502, 95%: 41.707, 99%: 54.504, max_rt: 87.930, 1503|175.694, 150|6.721, 149|170.767, 151|62.315
  60, trx: 1586, 95%: 43.077, 99%: 54.798, max_rt: 85.671, 1588|168.550, 159|15.743, 159|192.450, 158|67.230

STOPPING THREADS................

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Raw</span> <span class="token attr-name">Results</span><span class="token punctuation">&gt;</span></span>
  [0] sc:0 lt:9210  rt:0  fl:0 avg_rt: 27.6 (5)
  [1] sc:0 lt:9208  rt:0  fl:0 avg_rt: 75.7 (5)
  [2] sc:900 lt:21  rt:0  fl:0 avg_rt: 1.6 (5)
  [3] sc:0 lt:921  rt:0  fl:0 avg_rt: 149.0 (80)
  [4] sc:184 lt:738  rt:0  fl:0 avg_rt: 32.2 (20)
 in 60 sec.

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Raw</span> <span class="token attr-name">Results2(sum</span> <span class="token attr-name">ver.)</span><span class="token punctuation">&gt;</span></span>
  [0] sc:0  lt:9210  rt:0  fl:0 
  [1] sc:0  lt:9208  rt:0  fl:0 
  [2] sc:900  lt:21  rt:0  fl:0 
  [3] sc:0  lt:921  rt:0  fl:0 
  [4] sc:184  lt:738  rt:0  fl:0 

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Constraint</span> <span class="token attr-name">Check</span><span class="token punctuation">&gt;</span></span> (all must be [OK])
 [transaction percentage]
        Payment: 43.47% (&gt;=43.0%) [OK]
   Order-Status: 4.35% (&gt;= 4.0%) [OK]
       Delivery: 4.35% (&gt;= 4.0%) [OK]
    Stock-Level: 4.35% (&gt;= 4.0%) [OK]
 [response time (at least 90% passed)]
      New-Order: 0.00%  [NG] *
        Payment: 0.00%  [NG] *
   Order-Status: 97.72%  [OK]
       Delivery: 0.00%  [NG] *
    Stock-Level: 19.96%  [NG] *

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TpmC</span><span class="token punctuation">&gt;</span></span>
                 9210.000 TpmC
</code></pre><p>tps = 9210/60&#x2248;154</p>
<h2 id="3mysqlslap">3.mysqlslap</h2>
<p>mysqlslap &#x662F;&#x5B98;&#x65B9;&#x63D0;&#x4F9B;&#x7684;&#x6027;&#x80FD;&#x6D4B;&#x8BD5;&#x5DE5;&#x5177; </p>
<footer class="page-footer"><span class="copyright">Copyright &#xA9; suredandan 2018 all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification">UpdateTime: 
2018-11-28 06:34:24
</span></footer>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="16.basetest.html" class="navigation navigation-prev " aria-label="Previous page: 16.基准测试">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="18.replication.html" class="navigation navigation-next " aria-label="Next page: 18.主从复制">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"17.性能测试","level":"1.18","depth":1,"next":{"title":"18.主从复制","level":"1.19","depth":1,"path":"18.replication.md","ref":"18.replication.md","articles":[]},"previous":{"title":"16.基准测试","level":"1.17","depth":1,"path":"16.basetest.md","ref":"16.basetest.md","articles":[]},"dir":"ltr"},"config":{"plugins":["prism","prism-themes","-highlight","codesnippet","splitter","simple-page-toc","page-toc-button","back-to-top-button","-lunr","-search","search-plus","favicon@^0.0.2","tbfed-pagefooter@^0.0.1","theme-default","sitemap-general"],"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"Copyright © suredandan 2018","modify_label":"UpdateTime: ","modify_format":"YYYY-MM-DD HH:mm:ss"},"prism":{"css":["prismjs/themes/prism-solarizedlight.css"]},"simple-page-toc":{"maxDepth":3,"skipFirstH1":true},"splitter":{},"codesnippet":{},"sitemap-general":{"prefix":"http://www.googlebaba.io/mysql/"},"fontsettings":{"theme":"white","family":"sans","size":2},"favicon":{"shortcut":"favicon.ico","bookmark":"favicon.ico"},"page-toc-button":{},"back-to-top-button":{},"prism-themes":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"showLevel":true,"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"}},"search-plus":{},"image-captions":{"caption":"_CAPTION_"}},"theme":"default","author":"suredandan","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"MySQL搬砖","language":"zh-hans","gitbook":"*","description":"MySQL进阶指南"},"file":{"path":"17.performancetest.md","mtime":"2018-11-27T22:34:24.327Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-06-10T13:30:33.979Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-page-toc-button/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

